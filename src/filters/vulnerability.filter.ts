/**
 * Filter for routes that have a vulnerability in one of the nodes
 */

import { Graph } from '../models/graph.model';
import { Route } from '../types/graph.types';
import { Filter } from './base.filter';

export class VulnerabilityFilter implements Filter {
  name = 'hasVulnerability';

  apply(routes: Route[], graph: Graph): Route[] {
    return routes.filter(route => {
      // Check if any node in the route has vulnerabilities
      return route.path.some(nodeName => graph.hasVulnerabilities(nodeName));
    });
  }
}
